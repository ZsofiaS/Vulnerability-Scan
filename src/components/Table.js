import React from 'react';
import data from '../data/scan';
import TableRow from './TableRow';
import '../styles/App.css';

const Table = () => {

  const renderTableRows = () => {
    return data.scan.vulnerabilities.map((vulnerability, i) => {
      const { severity, name, description, solution, references, cvssBaseScore, affectedAssets } = vulnerability;
      return (
        <TableRow
          key={i}
          severity={severity}
          name={name}
          description={description}
          solution={solution}
          references={references}
          cvssBaseScore={cvssBaseScore}
          affectedAssets={affectedAssets}
          renderAssets={renderAssets(affectedAssets)}
        />
      )
    })
  }

  const renderAssets = (assets) => {
    return assets.map((asset, i) => {
      let item = data.scan.assets.find(obj => obj.id === asset);
      return (
        <p key={i}>{item.description} </p>
      )
    })
  }

  return (
    <table>
      <thead>
        <tr>
          <th>Severity</th>
          <th>Issue</th>
          <th>CVSS Base Score</th>
          <th>Affected Assets</th>
          <th>More info</th>
        </tr>
      </thead>
      <tbody>
        {renderTableRows()}
      </tbody>
    </table>
  )
}

export default Table;
