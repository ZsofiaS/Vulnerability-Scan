import React from 'react';
import data from '../data/scan';
import TableRow from './TableRow';

const Table = () => {

  const showInfo = (id) => {
    console.log(`Vulnerability id: ${id}`);
  }

  const renderTable = () => {
    return data.scan.vulnerabilities.map((vulnerability, i) => {
      const { id, severity, name, description, solution, references, cvssBaseScore, affectedAssets } = vulnerability;
      return (
        <TableRow
          key={i}
          severity={severity}
          name={name}
          description={description}
          solution={solution}
          references={references}
          cvssBaseScore={cvssBaseScore}
          affectedAssets={affectedAssets}
          renderAssets={renderAssets(affectedAssets)}
          showInfo={() => showInfo(id)}
        />
      )
    })
  }

  const renderAssets = (assets) => {
    return assets.map((asset, i) => {
      let item = data.scan.assets.find(obj => obj.id == asset);
      return (
        <span key={i}>{item.description} </span>
      )
    })
  }

  return (
    <table>
      <thead>
        <tr>
          <th>Severity</th>
          <th>Issue</th>
          {/*
          <th>Summary</th>
          <th>Solution</th>
          <th>References</th>
          */}
          <th>CVSS Base Score</th>
          <th>Affected Assets</th>
        </tr>
      </thead>
      <tbody>
        {renderTable()}
      </tbody>
    </table>
  )
}

export default Table;
