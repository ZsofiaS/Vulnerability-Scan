import React from 'react';
import Moment from 'react-moment';
import SeverityItem from './SeverityItem';
import '../styles/App.css';
import data from '../data/scan';

const Summary = () => {

  const { assets, severityCounts, name, status, dateStarted } = data.scan;

  const showAssets = () => {
    return (
      assets.map((asset, i) => {
        return (
          <li
            className="asset"
            key={i}>
            {asset.description} ({asset.name})
          </li>
        );
      })
    );
  };

  const showSeverities = () => {
    return (
      Object.keys(severityCounts).map((key, i) => {
        return (
          <SeverityItem
            key={i}
            severity={key}
            count={severityCounts[key]}
          />
        );
      })
    );
  };

  const convertDate = (date) => {
    return (
      <Moment format='Dd MMM HH:mm'>{date}</Moment>
    );
  };

  return (
    <div className="summary">
      <h1>{name}</h1>
      <h2>Summary</h2>
      <div className='summaryContainer'>
        <div className='status'>
          <p>Status: {status}</p>
          <p>Scan started: {convertDate(dateStarted)}</p>
        </div>
        <div className='assets'>
          <p>Scanned: </p>
          <ul>
            { showAssets() }
          </ul>
        </div>
        <div className='severities'>
          <p>Severities found:  </p>
          <ul>
            { showSeverities ()}
          </ul>
        </div>
      </div>
    </div>
  );
};

export default Summary;
