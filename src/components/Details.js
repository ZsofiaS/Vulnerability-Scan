import React from 'react';
import data from '../data/scan';

const Details = () => {

  const renderTable = () => {
    return data.scan.vulnerabilities.map((vulnerability, i) => {
      const { id, severity, name, description, solution, references, cvssBaseScore, affectedAssets } = vulnerability;
      return (
        <tr key={i}>
          <td>{severity}</td>
          <td>{name}</td>
          <td>{description}</td>
          <td>{solution}</td>
          <td>{references}</td>
          <td>{cvssBaseScore}</td>
          <td>{renderAssets(affectedAssets)}</td>
        </tr>
      )
    })
  }

  const renderAssets = (assets) => {
    return assets.map((asset, i) => {
      let item = data.scan.assets.find(obj => obj.id == asset);
      return (
        <span>{item.description} </span>
      )
    })
  }

  return (
    <div className="Details">
      <h1>Vulnerabilities found</h1>
      <table>
        <tr>
          <th>Severity</th>
          <th>Issue</th>
          <th>Summary</th>
          <th>Solution</th>
          <th>References</th>
          <th>CVSS Base Score</th>
          <th>Affected Assets</th>
        </tr>
        <tbody>
          {renderTable()}
        </tbody>
      </table>
    </div>
  )
}

export default Details;
